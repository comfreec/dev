<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ììŒ ìº”ë²„ìŠ¤ ë””ë²„ê·¸</title>
</head>
<body>
    <h1>ììŒ ìº”ë²„ìŠ¤ ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</h1>
    
    <div>
        <h2>ììŒ ìº”ë²„ìŠ¤ (writing-canvas)</h2>
        <canvas id="writing-canvas" width="300" height="300" style="border: 2px solid blue; cursor: crosshair;"></canvas>
        <br>
        <button onclick="testConsonantRecognize()">ììŒ ì¸ì‹ í…ŒìŠ¤íŠ¸</button>
        <button onclick="clearConsonantCanvas()">ììŒ ì§€ìš°ê¸°</button>
    </div>
    
    <div style="margin-top: 30px;">
        <h2>ëª¨ìŒ ìº”ë²„ìŠ¤ (vowel-canvas)</h2>
        <canvas id="vowel-canvas" width="300" height="300" style="border: 2px solid red; cursor: crosshair;"></canvas>
        <br>
        <button onclick="testVowelRecognize()">ëª¨ìŒ ì¸ì‹ í…ŒìŠ¤íŠ¸</button>
        <button onclick="clearVowelCanvas()">ëª¨ìŒ ì§€ìš°ê¸°</button>
    </div>
    
    <div id="logs" style="margin-top: 20px; background: #f0f0f0; padding: 10px; height: 200px; overflow-y: auto;"></div>

    <script>
        // ë¡œê·¸ ì¶œë ¥ í•¨ìˆ˜
        function log(message) {
            const logs = document.getElementById('logs');
            logs.innerHTML += new Date().toLocaleTimeString() + ': ' + message + '<br>';
            logs.scrollTop = logs.scrollHeight;
            console.log(message);
        }

        // ììŒ ìº”ë²„ìŠ¤ ë³€ìˆ˜ë“¤
        let canvas, ctx;
        let isDrawing = false;

        // ëª¨ìŒ ìº”ë²„ìŠ¤ ë³€ìˆ˜ë“¤  
        let vowelCanvas, vowelCtx;

        // ì´ˆê¸°í™”
        log('í˜ì´ì§€ ë¡œë“œë¨');
        
        // ììŒ ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
        canvas = document.getElementById('writing-canvas');
        if (canvas) {
            log('ììŒ ìº”ë²„ìŠ¤ ì°¾ìŒ');
            ctx = canvas.getContext('2d');
            ctx.lineWidth = 5;
            ctx.lineCap = 'round';
            ctx.strokeStyle = 'blue';

            canvas.addEventListener('mousedown', function(e) {
                log('ììŒ ìº”ë²„ìŠ¤ mousedown');
                isDrawing = true;
                draw(e);
            });

            canvas.addEventListener('mousemove', function(e) {
                if (isDrawing) {
                    draw(e);
                }
            });

            canvas.addEventListener('mouseup', function(e) {
                log('ììŒ ìº”ë²„ìŠ¤ mouseup - 2ì´ˆ í›„ ìë™ ì¸ì‹ ì‹œì‘');
                if (isDrawing) {
                    isDrawing = false;
                    ctx.beginPath();
                    
                    setTimeout(() => {
                        log('ììŒ ìë™ ì¸ì‹ ì‹¤í–‰');
                        testConsonantRecognize();
                    }, 2000);
                }
            });
        } else {
            log('âŒ ììŒ ìº”ë²„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
        }

        // ëª¨ìŒ ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
        vowelCanvas = document.getElementById('vowel-canvas');
        if (vowelCanvas) {
            log('ëª¨ìŒ ìº”ë²„ìŠ¤ ì°¾ìŒ');
            vowelCtx = vowelCanvas.getContext('2d');
            vowelCtx.lineWidth = 5;
            vowelCtx.lineCap = 'round';
            vowelCtx.strokeStyle = 'red';

            vowelCanvas.addEventListener('mousedown', function(e) {
                log('ëª¨ìŒ ìº”ë²„ìŠ¤ mousedown');
                isDrawing = true;
                drawVowel(e);
            });

            vowelCanvas.addEventListener('mousemove', function(e) {
                if (isDrawing) {
                    drawVowel(e);
                }
            });

            vowelCanvas.addEventListener('mouseup', function(e) {
                log('ëª¨ìŒ ìº”ë²„ìŠ¤ mouseup - 2ì´ˆ í›„ ìë™ ì¸ì‹ ì‹œì‘');
                if (isDrawing) {
                    isDrawing = false;
                    vowelCtx.beginPath();
                    
                    setTimeout(() => {
                        log('ëª¨ìŒ ìë™ ì¸ì‹ ì‹¤í–‰');
                        testVowelRecognize();
                    }, 2000);
                }
            });
        } else {
            log('âŒ ëª¨ìŒ ìº”ë²„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
        }

        // ììŒ ê·¸ë¦¬ê¸°
        function draw(e) {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        // ëª¨ìŒ ê·¸ë¦¬ê¸°
        function drawVowel(e) {
            const rect = vowelCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            vowelCtx.lineTo(x, y);
            vowelCtx.stroke();
            vowelCtx.beginPath();
            vowelCtx.moveTo(x, y);
        }

        // ììŒ ì¸ì‹ í…ŒìŠ¤íŠ¸
        function testConsonantRecognize() {
            log('ğŸ” ììŒ ì¸ì‹ í•¨ìˆ˜ í˜¸ì¶œë¨');
            
            const success = Math.random() > 0.5;
            if (success) {
                log('âœ… ììŒ: ë§ì·„ìŠµë‹ˆë‹¤!');
                speakText('ë§ì·„ìŠµë‹ˆë‹¤');
            } else {
                log('âŒ ììŒ: í‹€ë ¸ìŠµë‹ˆë‹¤!');
                speakText('í‹€ë ¸ìŠµë‹ˆë‹¤');
            }
        }

        // ëª¨ìŒ ì¸ì‹ í…ŒìŠ¤íŠ¸
        function testVowelRecognize() {
            log('ğŸ” ëª¨ìŒ ì¸ì‹ í•¨ìˆ˜ í˜¸ì¶œë¨');
            
            const success = Math.random() > 0.5;
            if (success) {
                log('âœ… ëª¨ìŒ: ë§ì·„ìŠµë‹ˆë‹¤!');
                speakText('ë§ì·„ìŠµë‹ˆë‹¤');
            } else {
                log('âŒ ëª¨ìŒ: í‹€ë ¸ìŠµë‹ˆë‹¤!');
                speakText('í‹€ë ¸ìŠµë‹ˆë‹¤');
            }
        }

        // ìŒì„± í•©ì„±
        function speakText(text) {
            log('ğŸ”Š ìŒì„± ì¬ìƒ ì‹œë„: ' + text);
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
                
                setTimeout(() => {
                    const utterance = new SpeechSynthesisUtterance();
                    utterance.lang = 'ko-KR';
                    utterance.text = text;
                    speechSynthesis.speak(utterance);
                    log('ğŸ”Š ìŒì„± ì¬ìƒë¨');
                }, 100);
            } else {
                log('âŒ ìŒì„± í•©ì„± ì§€ì› ì•ˆë¨');
            }
        }

        // ìº”ë²„ìŠ¤ ì§€ìš°ê¸°
        function clearConsonantCanvas() {
            log('ììŒ ìº”ë²„ìŠ¤ ì§€ìš°ê¸°');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function clearVowelCanvas() {
            log('ëª¨ìŒ ìº”ë²„ìŠ¤ ì§€ìš°ê¸°');
            vowelCtx.clearRect(0, 0, vowelCanvas.width, vowelCanvas.height);
        }
    </script>
</body>
</html>